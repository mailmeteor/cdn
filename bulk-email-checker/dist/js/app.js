(()=>{"use strict";var t={4838:(t,e,i)=>{var n=i(5471),s=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"bec-app-component h-100"},[e("div",{staticClass:"d-flex flex-column h-100 justify-content-end"},[e("router-view",{staticClass:"flex-grow-1 flex-shrink-0"}),e("img",{staticClass:"mw-100 mt-5 flex-shrink-0",attrs:{src:"https://cdn.jsdelivr.net/gh/mailmeteor/cdn@8.1.3/dist/img/sidebar/branded-footer.svg"}})],1)])},r=[];const a=n["default"].extend({name:"mailmeteor",watch:{isReady:{immediate:!0,handler:function(){this.isReady&&(this.hideSplashScreen(),this.redirectToHomePage())}}},computed:{isReady:function(){return this.$store.state.ready}},methods:{hideSplashScreen:function(){var t=document.getElementById("UILoader"),e=t&&t.parentNode;t&&e&&e.removeChild(t)},redirectToHomePage:function(){this.$router.replace({path:"/"})}}}),o=a;var c=i(1656),l=(0,c.A)(o,s,r,!1,null,null,null);const u=l.exports;var d=i(173),m=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("b-container",{staticClass:"home d-flex flex-column"},[e("div",{staticClass:"flex-grow-1"},[e("h1",{staticClass:"bec-title"},[t._v("Email verification")]),e("p",{staticClass:"bec-description"},[t._v("Verify email addresses directly in Google Sheets. Powerful, secure, and fast.")]),e("div",{staticClass:"home-email-address-column-picker mb-2"},[e("div",{staticClass:"bec-label mb-1"},[t._v("Email addresses")]),e("Dropdown",{attrs:{options:t.columns,"default-label":"Select email addresses column"},model:{value:t.selectedColumn,callback:function(e){t.selectedColumn=e},expression:"selectedColumn"}})],1),e("div",{staticClass:"home-column-options mt-2"},[e("div",{staticClass:"bec-label mb-1"},[t._v("Options")]),e("ColumnOptions",{attrs:{"column-options":t.columnOptions},model:{value:t.options,callback:function(e){t.options=e},expression:"options"}})],1),e("b-row",{staticClass:"justify-content-end m-0 mt-5"},[e("b-button",{staticClass:"mr-2",attrs:{variant:"outline-secondary"},on:{click:t.close}},[t._v("Cancel")]),e("b-button",{staticClass:"home-start-verification-button",attrs:{variant:"primary",disabled:t.isLoading},on:{click:t.startVerification}},[t.isLoading?e("b-spinner",{attrs:{small:"",type:"border"}}):e("span",[t._v("Start Verification")])],1)],1)],1),e("div",{staticClass:"flex-shrink-0"},[e("hr"),t.user.credits?e("b-row",{staticClass:"bec-description home-remaining-credits m-0 mb-1 align-items-center"},[e("div",{staticClass:"mr-1"},[t._v(t._s(t.user.credits.available)+" free credits available")]),e("img",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"Free credits allow you to verify emails for free every month. Once depleted you will be charged for each additional email that you verify.",src:"https://cdn.jsdelivr.net/gh/mailmeteor/cdn@7.9.3/dist/img/icons/info-outline.svg",height:"14px",width:"14px"}})]):t._e(),e("b-row",{staticClass:"bec-description home-links m-0 align-items-center"},[e("a",{staticClass:"mr-1",attrs:{href:"https://dashboard.mailmeteor.com/account",target:"_blank"}},[t._v("Account")]),t._v(" - "),e("a",{staticClass:"mx-1",attrs:{href:"https://dashboard.mailmeteor.com/billing",target:"_blank"}},[t._v("Billing")]),t._v(" - "),e("a",{staticClass:"ml-1",attrs:{href:"https://mailmeteor.com/docs/dashboard/",target:"_blank"}},[t._v("Tutorial")])])],1)])},f=[],h=(i(8111),i(1701),i(1635)),p=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"select-dropdown--component"},[e("b-form-input",{staticClass:"select-dropdown--input",attrs:{type:t.type,value:t.currentOptionLabel,"no-wheel":!0,step:"0",disabled:""}}),e("b-dropdown",{staticClass:"select-dropdown--dropdown",attrs:{"menu-class":"select-dropdown--dropdown-menu",variant:"transparent"}},t._l(t.options,(function(i){return e("b-dropdown-item",{key:i.value,staticClass:"select-dropdown--dropdown-item",on:{click:function(e){return t.$emit("input",i.value)}}},[t._v(" "+t._s(i.label)+" ")])})),1)],1)},v=[];i(116);const b=n["default"].extend({props:{value:{type:String,default:""},options:{type:Array,default:function(){return[{label:"Option 1",value:"option1"}]}},type:{type:String,default:"text"},defaultLabel:{type:String,default:"Select an option"}},computed:{currentOptionLabel:function(){var t=this,e=this.options.find((function(e){return e.value===t.value}));return e?e.label:this.defaultLabel}}}),g=b;var y=(0,c.A)(g,p,v,!1,null,null,null);const w=y.exports;var _=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"column-options-component"},[e("b-form-group",[e("b-form-checkbox-group",{attrs:{id:"column-options",checked:t.localColumnOptionsState,options:t.columnOptions,name:"column-options"},on:{input:t.setValues}})],1)],1)},C=[];i(2489),i(8237);const V=n["default"].extend({name:"ColumnOptions",props:{columnOptions:{type:Array,default:function(){return[]}},value:{type:Object,default:function(){return{}}}},computed:{localColumnOptionsState:function(){var t=this;return Object.keys(this.value).filter((function(e){return t.value[e]}))}},methods:{setValues:function(t){var e=this.columnOptions.reduce((function(e,i){return e[i.value]=t.includes(i.value),e}),{});this.$emit("input",e)}}}),k=V;var S=(0,c.A)(k,_,C,!1,null,null,null);const x=S.exports;var E=i(5353);const L=n["default"].extend({name:"home",components:{Dropdown:w,ColumnOptions:x},data:function(){return{columnOptions:[{text:"Data has header rows",value:"hasHeaderRows"},{text:"Include the verification details",value:"includeVerificationDetails"}],isLoading:!1}},computed:{user:function(){return this.$store.state.user},emailVerification:function(){return this.$store.state.emailVerification},selectedColumn:{get:function(){return this.$store.state.emailVerification.column},set:function(t){this.$store.dispatch("emailVerification/setEmailVerificationForm",{column:t})}},options:{get:function(){return this.$store.state.emailVerification.options},set:function(t){this.$store.dispatch("emailVerification/setEmailVerificationForm",{options:t})}},columns:function(){var t=this.$store.state.emailVerification.columns;return t?t.map((function(t){return{label:"Column ".concat(t),value:t}})):[]}},methods:(0,h.Cl)((0,h.Cl)({},(0,E.i0)({setEmailVerificationForm:"emailVerification/setEmailVerificationForm",fetchActiveSheetColumns:"emailVerification/fetchActiveSheetColumns",fetchEmailsFromEmailColumn:"emailVerification/fetchEmailsFromEmailColumn",createEmailVerificationList:"emailVerification/createEmailVerificationList"})),{startVerification:function(){return(0,h.sH)(this,void 0,void 0,(function(){return(0,h.YH)(this,(function(t){switch(t.label){case 0:if(this.isLoading)return[2];if(!this.selectedColumn)return this.$bvToast.toast("Please select a column with email addresses.",{title:"Missing column",variant:"warning",solid:!0}),[2];this.isLoading=!0,t.label=1;case 1:return t.trys.push([1,4,5,6]),[4,this.fetchEmailsFromEmailColumn()];case 2:return t.sent(),0===this.emailVerification.emails.length?(this.$bvToast.toast("No email addresses found in the selected column.",{title:"No emails",variant:"warning",solid:!0}),[2]):[4,this.createEmailVerificationList()];case 3:return t.sent(),[3,6];case 4:return t.sent(),this.$bvToast.toast("Failed to create email verification list.",{title:"Error",variant:"danger",solid:!0}),[2];case 5:return this.isLoading=!1,[7];case 6:return this.$router.push({path:"/checkout"}),[2]}}))}))},close:function(){window.google.script.host.close()}})}),P=L;var H=(0,c.A)(P,m,f,!1,null,"37ddf5c5",null);const F=H.exports;var A=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("b-container",{staticClass:"checkout"},[e("h1",{staticClass:"bec-title"},[t._v("Confirm order")]),e("CheckoutDetails",{attrs:{"free-credits":t.freeCredits,"free-checkout":t.isFreeCheckout,loading:t.loading},on:{confirm:t.confirmCheckout}})],1)},$=[],O=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"checkout-details-component"},[e("b-row",{staticClass:"bec-description mb-1"},[e("b-col",[t._v("Emails in your list")]),e("b-col",[t._v(t._s(t.emails.length))])],1),t.freeCredits>0?e("b-row",{staticClass:"bec-description mb-1"},[e("b-col",{staticClass:"align-items-center d-flex"},[t._v(" Free credits "),e("FreeCreditsInfo",{attrs:{"free-credits":t.freeCredits,"used-credits":Math.min(t.emails.length,t.freeCredits)}})],1),e("b-col",[t._v("-"+t._s(Math.min(t.emails.length,t.freeCredits))+" ")])],1):t._e(),e("hr"),e("b-row",{staticClass:"bec-description mb-1"},[e("b-col",[t._v("Total emails")]),e("b-col",[t._v(t._s(t.numberOfEmailsRemaining)+" emails")])],1),e("b-row",{staticClass:"bec-description mb-1"},[e("b-col",[t._v("Price per email")]),e("b-col",[t._v(t._s(t._f("formatPrice")(.01))+" per email")])],1),e("hr"),t.freeCheckout?t._e():[e("b-row",{staticClass:"bec-description mb-1"},[e("b-col",[t._v("Subtotal")]),e("b-col",[t._v(t._s(t._f("formatPrice")(t.subtotal)))])],1),e("b-row",{staticClass:"bec-description mb-1"},[e("b-col",[t._v("Minimum charge")]),e("b-col",[t._v(t._s(t._f("formatPrice")(.5)))])],1),e("hr")],e("b-row",{staticClass:"bec-description"},[e("b-col",[t._v("Total (excl. taxes)")]),e("b-col",{staticClass:"checkout-details__total"},[t._v(t._s(t._f("formatPrice")(t.total)))])],1),e("div",{staticClass:"terms-of-uses bec-description mt-3 mb-4"},[t._v(" By clicking "),e("strong",[t._v(t._s(t.confirmLabel))]),t._v(" you agree to the "),e("a",{attrs:{href:"https://mailmeteor.com/legal/terms"}},[t._v("Mailmeteor Agreement")]),t._v(", and the "),e("a",{attrs:{href:"https://mailmeteor.com/legal/bounceshield"}},[t._v("Supplemental Term for Mailmeteor BounceShield Agreement")]),t._v(". ")]),e("b-row",{staticClass:"justify-content-end mt-5 mr-0"},[e("b-button",{staticClass:"mr-2",attrs:{variant:"outline-secondary",disabled:t.loading},on:{click:function(e){return t.$router.back()}}},[t._v("Cancel")]),e("b-button",{staticClass:"confirm-btn",attrs:{variant:"primary",disabled:t.loading},on:{click:function(e){return t.$emit("confirm")}}},[t.loading?e("b-spinner",{attrs:{small:"",type:"border"}}):e("span",[t._v(t._s(t.confirmLabel))])],1)],1)],2)},I=[],U=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("img",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"ml-1",attrs:{src:"https://cdn.jsdelivr.net/gh/mailmeteor/cdn@7.9.3/dist/img/icons/info-outline.svg",height:"14px",width:"14px",title:t.remainingCredits}})},Y=[];const D=n["default"].extend({name:"FreeCreditsInfo",props:{freeCredits:{type:Number,required:!0},usedCredits:{type:Number,required:!0}},computed:{remainingCredits:function(){return"You will use ".concat(this.usedCredits," credits out of your monthly quota of ").concat(this.freeCredits," free credits remaining.")}}}),j=D;var T=(0,c.A)(j,U,Y,!1,null,null,null);const M=T.exports,R=n["default"].extend({name:"checkout-details",components:{FreeCreditsInfo:M},props:{freeCheckout:{type:Boolean,required:!0},loading:{type:Boolean,required:!0},freeCredits:{type:Number,required:!0}},computed:{confirmLabel:function(){return this.freeCheckout?"Start":"Proceed to payment"},emailVerification:function(){return this.$store.state.emailVerification},emails:function(){return this.emailVerification.emails},numberOfEmailsRemaining:function(){return Math.max(this.emails.length-this.freeCredits,0)},subtotal:function(){return.01*(this.emails.length-this.freeCredits)},total:function(){return this.freeCheckout?0:Math.max(this.subtotal,.5)}}}),B=R;var N=(0,c.A)(B,O,I,!1,null,null,null);const z=N.exports,q=n["default"].extend({name:"Checkout",components:{CheckoutDetails:z},data:function(){return{loading:!1}},computed:{emailVerificationListId:function(){return this.$store.state.emailVerificationListId},paymentLink:function(){return this.$store.state.emailVerification.paymentLink},isFreeCheckout:function(){return!this.paymentLink},freeCredits:function(){return this.$store.state.user.credits.available}},methods:{confirmCheckout:function(){return this.isFreeCheckout?this.processFreeCheckout():this.processPayment()},processFreeCheckout:function(){var t=this;this.loading=!0,this.$store.dispatch("emailVerification/startFreeEmailVerificationList").then((function(){t.$router.push("/processing-verification")})).catch((function(){t.$bvToast.toast("We could not start the verification list",{title:"Unexpected error",variant:"danger"})})).finally((function(){t.loading=!1}))},processPayment:function(){if(!this.paymentLink)throw new Error("Payment link not found");window.open(this.paymentLink,"_blank"),this.$router.push("/processing-payment")}}}),G=q;var W=(0,c.A)(G,A,$,!1,null,null,null);const J=W.exports;var Z=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("b-container",{staticClass:"processing-payment-page"},[e("ProcessState",{attrs:{title:"Payment in progress...",message:"Waiting for your payment to complete",actions:t.actions},on:{cancel:t.cancelPayment}})],1)},K=[],Q=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"process-state-component"},[e("b-row",{staticClass:"text-center mb-3 mt-3"},[e("b-col",["loading"===t.type?e("b-spinner",{staticClass:"spinner",attrs:{variant:"primary"}}):e("img",{staticClass:"success-img",attrs:{src:"https://cdn.jsdelivr.net/gh/mailmeteor/cdn@7.9.3/dist/img/icons/done.svg"}})],1)],1),e("b-row",{staticClass:"mb-1"},[e("b-col",[e("h1",{staticClass:"bec-title text-center"},[t._v(t._s(t.title))])])],1),e("b-row",{staticClass:"mb-2"},[e("b-col",[e("p",{staticClass:"bec-description text-center"},[t._v(t._s(t.message))])])],1),e("b-row",{staticClass:"justify-content-center align-items-center action-buttons"},t._l(t.actions,(function(i){return e("b-col",{key:i.event,staticClass:"p-0 action-button"},[e("b-button",{key:i.event,attrs:{variant:i.type},on:{click:function(e){return t.$emit(i.event)}}},[t._v(" "+t._s(i.label)+" ")])],1)})),1)],1)},X=[];const tt=n["default"].extend({name:"LoadingState",props:{type:{type:String,default:"loading"},title:{type:String,default:"Loading..."},message:{type:String,default:"Please wait while we load the data."},actions:{type:Array,default:function(){return[]}}}}),et=tt;var it=(0,c.A)(et,Q,X,!1,null,null,null);const nt=it.exports,st=n["default"].extend({name:"ProcessingPaymentPage",components:{ProcessState:nt},data:function(){return{actions:[{label:"Cancel",event:"cancel",type:"outline-secondary"}]}},computed:{emailVerificationList:function(){return this.$store.state.emailVerification.emailVerificationList}},methods:{cancelPayment:function(){this.$store.dispatch("emailVerification/cancelPayment"),this.$router.replace({path:"/"})}},watch:{"emailVerificationList.status":{immediate:!0,handler:function(t){"active"===t?this.$router.push({path:"/processing-verification"}):"ended"===t&&this.$router.push({path:"/verification-complete"})}}}}),rt=st;var at=(0,c.A)(rt,Z,K,!1,null,null,null);const ot=at.exports;var ct=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"processing-verification-page"},[e("ProcessState",{attrs:{title:"Verification in progress...",message:"Your spreadsheet will be automatically updated in the background with the verification results."}})],1)},lt=[];const ut=n["default"].extend({name:"ProcessingPaymentPage",components:{ProcessState:nt},computed:{emailVerificationList:function(){return this.$store.state.emailVerification.emailVerificationList}},watch:{"emailVerificationList.status":{immediate:!0,handler:function(t){"ended"===t&&this.$router.push({path:"/verification-complete"})}}}}),dt=ut;var mt=(0,c.A)(dt,ct,lt,!1,null,null,null);const ft=mt.exports;var ht=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("b-container",{staticClass:"processing-payment-page"},[e("ProcessState",{attrs:{type:"success",title:"Verification completed",message:`Your list of ${t.emailVerification.emails.length} emails has been successfully verified.`,actions:t.actions},on:{cancel:t.cancel,"new-verification":t.newVerification}})],1)},pt=[];const vt=n["default"].extend({name:"ProcessingPaymentPage",components:{ProcessState:nt},data:function(){return{actions:[{label:"Cancel",event:"cancel",type:"outline-secondary"},{label:"New verification",event:"new-verification",type:"primary"}]}},computed:{emailVerification:function(){return this.$store.state.emailVerification}},methods:(0,h.Cl)((0,h.Cl)({},(0,E.i0)({resetEmailVerificationForm:"emailVerification/resetEmailVerificationForm"})),{newVerification:function(){this.resetEmailVerificationForm(),this.$router.replace({path:"/"})},cancel:function(){this.resetEmailVerificationForm(),this.$router.replace({path:"/"}),window.google.script.host.close()}})}),bt=vt;var gt=(0,c.A)(bt,ht,pt,!1,null,null,null);const yt=gt.exports;n["default"].use(d.Ay);var wt=[{path:"/",component:F},{path:"/checkout",component:J},{path:"/processing-payment",component:ot},{path:"/processing-verification",component:ft},{path:"/verification-complete",component:yt}];const _t=new d.Ay({mode:"history",routes:wt});i(1148),i(4979);var Ct=i(9988);i(4364),i(8889);function Vt(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return new Promise((function(i,n){var s;(s=window.google.script.run.withSuccessHandler(i).withFailureHandler(n||window.errorBackendHandler))[t].apply(s,e)}))}i(1690),i(5611);var kt=i(7091);function St(t,e){return void 0===e&&(e=!1),(0,h.sH)(this,void 0,Promise,(function(){var i,n,s;return(0,h.YH)(this,(function(r){switch(r.label){case 0:return i=Ct.A.database().ref(t),e?[4,i.get()]:[3,2];case 1:return s=r.sent(),[3,4];case 2:return[4,i.once("value")];case 3:s=r.sent(),r.label=4;case 4:return n=s,[2,n.val()||{}]}}))}))}function xt(t){return(0,h.sH)(this,void 0,Promise,(function(){var e;return(0,h.YH)(this,(function(i){switch(i.label){case 0:return[4,t.get()];case 1:return e=i.sent(),[2,e.docs.map((function(t){return(0,h.Cl)({id:t.id},t.data())}))]}}))}))}function Et(t){return new kt.c((function(e){var i=t.onSnapshot((function(t){var i=t.docs.map((function(t){return(0,h.Cl)({id:t.id},t.data())}));e.next(i)}),(function(t){e.error(t)}));return function(){return i()}}))}function Lt(t){return"emvl_".concat(t)}function Pt(t,e){var i=Ct.A.firestore().collection("email_verification_lists").where("owner","==",t).where("googlesheets.sheet","==",e).where("status","!=","payment_required").orderBy("status").orderBy("updated_at","desc").limit(1);return Et(i)}function Ht(t,e){return(0,h.sH)(this,void 0,void 0,(function(){var i,n;return(0,h.YH)(this,(function(s){return i=e.id,n=Ct.A.firestore().collection("email_verifications").where("owner","==",t).where("verification_list","==","emvl_".concat(i)).orderBy("created_at","desc"),[2,xt(n)]}))}))}function Ft(t){var e=Ct.A.database(),i=e.ref("users/".concat(t,"/credits/email_verification"));return new kt.c((function(t){return i.on("value",(function(e){var i=e.val();i&&t.next(i)})),function(){i.off()}}))}function At(t,e){var i=e.id,n=Ct.A.firestore().collection("email_verifications").where("owner","==",t).where("verification_list","==","emvl_".concat(i)).orderBy("created_at","desc");return Et(n)}function $t(t,e){return(0,h.sH)(this,void 0,Promise,(function(){var i,n;return(0,h.YH)(this,(function(s){switch(s.label){case 0:return i=Ct.A.functions().httpsCallable(t),[4,i(e)];case 1:return n=s.sent(),[2,n.data]}}))}))}var Ot={uid:"",email:"",credits:{available:50,refreshDate:""},blocked:!1,isLogged:!1,isProfileFetched:!1},It={initialize:function(t){return(0,h.sH)(this,void 0,void 0,(function(){var e,i;return(0,h.YH)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,t.dispatch("signin")];case 1:return e=n.sent(),[4,t.dispatch("fetchProfile",e)];case 2:return n.sent(),t.dispatch("onDataFetched"),[3,4];case 3:return i=n.sent(),i instanceof Error&&"Multiple accounts detected!"===i.message?[2]:(t.dispatch("signInFailed",i),[3,4]);case 4:return[2]}}))}))},onDataFetched:function(t){t.dispatch("ready","user",{root:!0})},fetchProfile:function(t){return(0,h.sH)(this,void 0,Promise,(function(){var e,i,n,s;return(0,h.YH)(this,(function(r){switch(r.label){case 0:if(e=Ct.A.auth().currentUser,!e)throw new Error("User is not signed in.");return[4,St("users/".concat(e.uid,"/profile"))];case 1:return i=r.sent(),n=e.email||"",s={uid:e.uid,blocked:(null===i||void 0===i?void 0:i.blocked)||!1,email:n},t.commit("set",s),t.dispatch("fetchCredits"),[2,s]}}))}))},fetchCredits:function(t){var e=!1,i=Ct.A.auth().currentUser;if(!i)throw new Error("User is not signed in.");Ft(i.uid).subscribe((function(i){e||t.dispatch("onDataFetched"),e=!0,t.commit("setCredits",i)}))},signin:function(t){return(0,h.sH)(this,void 0,Promise,(function(){var e,i;return(0,h.YH)(this,(function(n){switch(n.label){case 0:return[4,Dt()];case 1:return e=n.sent(),e?[3,3]:[4,jt()];case 2:e=n.sent(),n.label=3;case 3:if(!(null===e||void 0===e?void 0:e.user))throw new Error("Unable to sign in");return i=e.user,t.state.uid=i.uid,t.state.email=i.email||"",t.dispatch("onAuthChange"),t.dispatch("logged",!0),[2,e]}}))}))},onAuthChange:function(t){var e=this;Ct.A.auth().onAuthStateChanged((function(i){return(0,h.sH)(e,void 0,void 0,(function(){var e;return(0,h.YH)(this,(function(n){switch(n.label){case 0:if(i)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,t.dispatch("signin")];case 2:return n.sent(),[3,4];case 3:return e=n.sent(),t.dispatch("loggedOut",e),[3,4];case 4:return[2]}}))}))}))},logged:function(t,e){t.commit("logged",e)},loggedOut:function(t,e){t.dispatch("logged",!1),window._logger(e)},signInFailed:function(t,e){t.dispatch("logged",!1),window._logger(e)},signout:function(){Ct.A.auth().signOut()}},Ut={set:function(t,e){t.uid=e.uid,t.email=e.email,t.blocked=e.blocked,t.isProfileFetched=!0},logged:function(t,e){t.isLogged=e},setCredits:function(t,e){t.credits=e}};const Yt={namespaced:!0,state:Ot,actions:It,mutations:Ut};function Dt(){return(0,h.sH)(this,void 0,void 0,(function(){var t,e,i,n;return(0,h.YH)(this,(function(s){switch(s.label){case 0:if(t=JSON.parse(Rt("credential")||"{}"),e=null===t||void 0===t?void 0:t.token,i=(null===t||void 0===t?void 0:t.token_expires_at)||0,n=e&&i>Date.now()+6e5,!n)return[2,null];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Ct.A.auth().signInWithCustomToken(e)];case 2:return[2,s.sent()];case 3:return s.sent(),[2,null];case 4:return[2]}}))}))}function jt(){return(0,h.sH)(this,void 0,void 0,(function(){var t,e,i,n,s;return(0,h.YH)(this,(function(r){switch(r.label){case 0:return[4,Vt("UIDataCurrentUserSession")];case 1:if(t=r.sent(),e=t.oauth_token,i=t.email,!e)throw new Error("Missing user session token");if(!i)throw new Error("Missing user email");if(i!==window._app.data.activeUserEmail)throw new Error("Multiple accounts detected!");return[4,Ct.A.functions().httpsCallable("addon_gworkspace-login")({email:i,oauth_token:e})];case 2:if(n=r.sent(),s=n.data.token,!s)throw new Error("Unable to retrieve user token from Firebase");return Mt("credential",JSON.stringify({token:s,token_expires_at:Date.now()+33e5})),[2,Ct.A.auth().signInWithCustomToken(s)]}}))}))}function Tt(t){var e=btoa(window._app.data.activeUserEmail||Date.now().toString()),i="MM_USER_".concat(e,"_").concat(t.toUpperCase());return i}function Mt(t,e){try{window.sessionStorage.setItem(Tt(t),e)}catch(i){}}function Rt(t){try{return window.sessionStorage.getItem(Tt(t))}catch(e){return null}}var Bt=i(6126),Nt=i(3720),zt=(i(7588),function(){function t(){this.subscriptions=new Map}return t.prototype.set=function(t,e){this.unsubscribe(t),this.subscriptions.set(t,e)},t.prototype.unsubscribe=function(t){var e;this.subscriptions.has(t)&&(null===(e=this.subscriptions.get(t))||void 0===e||e.unsubscribe(),this.subscriptions.delete(t))},t.prototype.unsubscribeAll=function(){this.subscriptions.forEach((function(t){return t.unsubscribe()})),this.subscriptions.clear()},t}()),qt=new zt,Gt=i(9449),Wt=function(){function t(t,e){this.uid=t,this.emailVerificationList=e,this.subscription=null,this.flushInterval=2e3}return t.prototype.updateEmailVerificationList=function(){var t=this;this.subscription&&this.stop();var e=At(this.uid,this.emailVerificationList);this.subscription=e.pipe((0,Gt.Z)(this.flushInterval)).subscribe((function(e){return t.updateSheet(e)})),qt.set("emailVerificationSheetHandler",this.subscription)},t.prototype.stop=function(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null,qt.unsubscribe("emailVerificationSheetHandler"))},t.prototype.updateSheet=function(t){return(0,h.sH)(this,void 0,Promise,(function(){var e;return(0,h.YH)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t.length>0?[4,Vt("UIUpdateSheetStatuses",this.emailVerificationList,t)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[3,4];case 3:return e=i.sent(),console.error("Failed to update Google Sheet:",e),[3,4];case 4:return[2]}}))}))},t}(),Jt={sheet:"",emails:[],options:{hasHeaderRows:!1,includeVerificationDetails:!1},column:"",emailVerificationListId:"",emailVerificationList:null,paymentLink:"",columns:[],sheetHandler:null},Zt={initialize:function(t){return(0,h.sH)(this,void 0,void 0,(function(){var e;return(0,h.YH)(this,(function(i){switch(i.label){case 0:return e=[t.dispatch("fetchActiveSheetColumns"),t.dispatch("fetchDefaultEmailColumn")],[4,Promise.all(e)];case 1:return i.sent(),t.dispatch("ready","emailVerification",{root:!0}),[2]}}))}))},setSheet:function(t,e){t.commit("setSheet",e),t.dispatch("sheetChanged",e,{root:!0})},setEmailVerificationForm:function(t,e){t.commit("setEmailVerificationForm",e)},resetEmailVerificationForm:function(t){t.commit("resetEmailVerificationForm")},fetchActiveSheetColumns:function(t){return(0,h.sH)(this,void 0,void 0,(function(){var e;return(0,h.YH)(this,(function(i){switch(i.label){case 0:return[4,Vt("UIGetAllColumnsFromCurrentSheet")];case 1:return e=i.sent(),t.commit("setColumns",e),[2]}}))}))},fetchDefaultEmailColumn:function(t){return(0,h.sH)(this,void 0,void 0,(function(){var e;return(0,h.YH)(this,(function(i){switch(i.label){case 0:return[4,Vt("UIGetEmailColumnFromCurrentSheet")];case 1:return e=i.sent(),t.dispatch("setSheet",e.sheet),t.commit("setEmailVerificationForm",{column:e.columnHeading,options:(0,h.Cl)((0,h.Cl)({},t.state.options),{hasHeaderRows:e.hasHeader})}),[2]}}))}))},fetchEmailsFromEmailColumn:function(t){return(0,h.sH)(this,void 0,void 0,(function(){var e,i,n,s;return(0,h.YH)(this,(function(r){switch(r.label){case 0:return e=t.state,i=e.column,n=e.options,i?[4,Vt("UIGetEmailsFromCurrentSheet",i,n.hasHeaderRows)]:[2];case 1:return s=r.sent(),t.commit("setEmailVerificationForm",{emails:s}),[2]}}))}))},fetchEmailVerificationLists:function(t,e){var i=this,n=Pt(e,t.state.sheet),s=n.pipe((0,Bt.p)((function(t){return t.length>0})),(0,Nt.n)((function(t){return(0,h.sH)(i,void 0,void 0,(function(){return(0,h.YH)(this,(function(e){return[2,t[0]]}))}))}))).subscribe((function(n){return(0,h.sH)(i,void 0,void 0,(function(){var i,s;return(0,h.YH)(this,(function(r){switch(r.label){case 0:return t.state.emailVerificationListId&&t.state.emailVerificationListId!==Lt(n.id)?[2]:(t.commit("setEmailVerificationList",n),"active"!==n.status?[3,2]:(i=new Wt(e,n),t.commit("setSheetHandler",i),[4,Vt("UISetSheetVerifyingStatusColumn",n.googlesheets.add_details,n)]));case 1:return r.sent(),i.updateEmailVerificationList(),[3,4];case 2:return"ended"!==n.status?[3,4]:(t.commit("setSheetHandler",null),[4,Ht(e,n)]);case 3:return s=r.sent(),[2,Vt("UIUpdateSheetStatuses",n,s)];case 4:return[2]}}))}))}));qt.set("emailVerificationLists",s)},createEmailVerificationList:function(t){return(0,h.sH)(this,void 0,void 0,(function(){var e,i,n,s,r,a,o,c,l;return(0,h.YH)(this,(function(u){switch(u.label){case 0:return e=t.state,i=e.emails,n=e.column,s=e.options,r={emailingColumn:n,options:{hasHeader:s.hasHeaderRows,addDetails:s.includeVerificationDetails},emails:i},[4,Vt("UICreateVerificationList",r)];case 1:return a=u.sent(),o=a.id,c=a.payment_link,l=a.sheet,t.commit("initializeEmailVerificationList",{id:o,payment_link:c}),t.dispatch("setSheet",l),[2]}}))}))},startFreeEmailVerificationList:function(t){return $t("email_verification_list-start_free",{emailVerificationListId:t.state.emailVerificationListId})},cancelPayment:function(t){t.commit("setEmailVerificationList",null),t.commit("initializeEmailVerificationList",{id:"",payment_link:""})}},Kt={setEmailVerificationForm:function(t,e){e.options&&(t.options=e.options),e.column&&(t.column=e.column),e.emails&&(t.emails=e.emails)},initializeEmailVerificationList:function(t,e){t.emailVerificationList=null,t.emailVerificationListId=e.id,t.paymentLink=e.payment_link},setEmailVerificationList:function(t,e){t.emailVerificationList=e},resetEmailVerificationForm:function(t){t.emails=[],t.options={hasHeaderRows:!1,includeVerificationDetails:!1},t.column=""},setColumns:function(t,e){t.columns=e},setSheet:function(t,e){t.sheet=e},setSheetHandler:function(t,e){t.sheetHandler&&t.sheetHandler.stop(),t.sheetHandler=e}};const Qt={namespaced:!0,state:Jt,actions:Zt,mutations:Kt};n["default"].use(E.Ay);const Xt=new E.Ay.Store({modules:{user:Yt,emailVerification:Qt},state:{ready:!1,loaded:{user:!1,emailVerification:!1}},actions:{ready:function(t,e){t.commit("loaded",e);var i=Object.values(t.state.loaded).every((function(t){return t}));if(i)return t.commit("ready")},sheetChanged:function(t){t.dispatch("emailVerification/fetchEmailVerificationLists",Yt.state.uid,{root:!0})}},mutations:{ready:function(t){t.ready=!0},loaded:function(t,e){t.loaded[e]=!0}}});n["default"].filter("formatPrice",(function(t){return"number"!==typeof t?"Invalid value":t.toLocaleString("en-US",{style:"currency",currency:"USD"})}));var te=i(8292);i(9313);n["default"].use(te.vGs),new n["default"]({store:Xt,router:_t,render:function(t){return t(u)},created:function(){Ct.A.initializeApp(window._app&&window._app.firebase),this.$store.dispatch("user/initialize"),this.$store.dispatch("emailVerification/initialize")}}).$mount("#app")}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var r=e[n]={exports:{}};return t[n].call(r.exports,r,r.exports,i),r.exports}i.m=t,(()=>{var t=[];i.O=(e,n,s,r)=>{if(!n){var a=1/0;for(u=0;u<t.length;u++){for(var[n,s,r]=t[u],o=!0,c=0;c<n.length;c++)(!1&r||a>=r)&&Object.keys(i.O).every((t=>i.O[t](n[c])))?n.splice(c--,1):(o=!1,r<a&&(a=r));if(o){t.splice(u--,1);var l=s();void 0!==l&&(e=l)}}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[n,s,r]}})(),(()=>{i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}})(),(()=>{i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()})(),(()=>{i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e)})(),(()=>{i.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}})(),(()=>{var t={524:0};i.O.j=e=>0===t[e];var e=(e,n)=>{var s,r,[a,o,c]=n,l=0;if(a.some((e=>0!==t[e]))){for(s in o)i.o(o,s)&&(i.m[s]=o[s]);if(c)var u=c(i)}for(e&&e(n);l<a.length;l++)r=a[l],i.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return i.O(u)},n=globalThis["webpackChunknewapp"]=globalThis["webpackChunknewapp"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var n=i.O(void 0,[504],(()=>i(4838)));n=i.O(n)})();