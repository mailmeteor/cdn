(()=>{"use strict";var t={3368:(t,e,i)=>{var n=i(5471),s=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"bec-app-component h-100"},[e("div",{staticClass:"d-flex flex-column h-100 justify-content-end"},[e("router-view",{staticClass:"flex-grow-1 flex-shrink-0"}),e("img",{staticClass:"mw-100 mt-5 flex-shrink-0",attrs:{src:"https://cdn.jsdelivr.net/gh/mailmeteor/cdn@8.1.3/dist/img/sidebar/branded-footer.svg"}})],1)])},a=[];const r=n["default"].extend({name:"mailmeteor",watch:{isReady:{immediate:!0,handler:function(){this.isReady&&(this.hideSplashScreen(),this.redirectToHomePage())}}},computed:{isReady:function(){return this.$store.state.ready}},methods:{hideSplashScreen:function(){var t=document.getElementById("UILoader"),e=t&&t.parentNode;t&&e&&e.removeChild(t)},redirectToHomePage:function(){this.$router.replace({path:"/"})}}}),o=r;var c=i(1656),l=(0,c.A)(o,s,a,!1,null,null,null);const u=l.exports;var m=i(173),d=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("b-container",{staticClass:"home d-flex flex-column"},[e("div",{staticClass:"flex-grow-1"},[e("h1",{staticClass:"bec-title"},[t._v("Email verification")]),e("p",{staticClass:"bec-description"},[t._v("Verify email addresses directly in Google Sheets. Powerful, secure, and fast.")]),e("div",{staticClass:"home-email-address-column-picker mb-2"},[e("div",{staticClass:"bec-label mb-1"},[t._v("Email addresses")]),e("Dropdown",{attrs:{options:t.columns,"default-label":"Select email addresses column"},model:{value:t.selectedColumn,callback:function(e){t.selectedColumn=e},expression:"selectedColumn"}})],1),e("div",{staticClass:"home-column-options mt-2"},[e("div",{staticClass:"bec-label mb-1"},[t._v("Options")]),e("ColumnOptions",{attrs:{"column-options":t.columnOptions},model:{value:t.options,callback:function(e){t.options=e},expression:"options"}})],1),e("b-row",{staticClass:"justify-content-end m-0 mt-5"},[e("b-button",{staticClass:"mr-2",attrs:{variant:"outline-secondary"},on:{click:t.close}},[t._v("Cancel")]),e("b-button",{staticClass:"home-start-verification-button",attrs:{variant:"primary",disabled:t.isLoading},on:{click:t.startVerification}},[t.isLoading?e("b-spinner",{attrs:{small:"",type:"border"}}):e("span",[t._v("Start Verification")])],1)],1)],1),e("div",{staticClass:"flex-shrink-0"},[e("hr"),e("b-row",{staticClass:"bec-description home-links m-0 align-items-center"},[e("a",{staticClass:"mr-1",attrs:{href:"https://dashboard.mailmeteor.com/account",target:"_blank"}},[t._v("Account")]),t._v(" - "),e("a",{staticClass:"mx-1",attrs:{href:"https://dashboard.mailmeteor.com/billing",target:"_blank"}},[t._v("Billing")]),t._v(" - "),e("a",{staticClass:"ml-1",attrs:{href:"https://mailmeteor.com/docs/dashboard/",target:"_blank"}},[t._v("Tutorial")])])],1)])},f=[],h=(i(8111),i(1701),i(1635)),p=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"select-dropdown--component"},[e("b-form-input",{staticClass:"select-dropdown--input",attrs:{type:t.type,value:t.currentOptionLabel,"no-wheel":!0,step:"0",disabled:""}}),e("b-dropdown",{staticClass:"select-dropdown--dropdown",attrs:{"menu-class":"select-dropdown--dropdown-menu",variant:"transparent"}},t._l(t.options,(function(i){return e("b-dropdown-item",{key:i.value,staticClass:"select-dropdown--dropdown-item",on:{click:function(e){return t.$emit("input",i.value)}}},[t._v(" "+t._s(i.label)+" ")])})),1)],1)},v=[];i(116);const b=n["default"].extend({props:{value:{type:String,default:""},options:{type:Array,default:function(){return[{label:"Option 1",value:"option1"}]}},type:{type:String,default:"text"},defaultLabel:{type:String,default:"Select an option"}},computed:{currentOptionLabel:function(){var t=this,e=this.options.find((function(e){return e.value===t.value}));return e?e.label:this.defaultLabel}}}),g=b;var w=(0,c.A)(g,p,v,!1,null,null,null);const y=w.exports;var _=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"column-options-component"},[e("b-form-group",[e("b-form-checkbox-group",{attrs:{id:"column-options",checked:t.localColumnOptionsState,options:t.columnOptions,name:"column-options"},on:{input:t.setValues}})],1)],1)},C=[];i(2489),i(8237);const V=n["default"].extend({name:"ColumnOptions",props:{columnOptions:{type:Array,default:function(){return[]}},value:{type:Object,default:function(){return{}}}},computed:{localColumnOptionsState:function(){var t=this;return Object.keys(this.value).filter((function(e){return t.value[e]}))}},methods:{setValues:function(t){var e=this.columnOptions.reduce((function(e,i){return e[i.value]=t.includes(i.value),e}),{});this.$emit("input",e)}}}),S=V;var k=(0,c.A)(S,_,C,!1,null,null,null);const E=k.exports;var x=i(5353);const H=n["default"].extend({name:"home",components:{Dropdown:y,ColumnOptions:E},data:function(){return{columnOptions:[{text:"Data has header rows",value:"hasHeaderRows"},{text:"Include the verification details",value:"includeVerificationDetails"}],isLoading:!1}},computed:{user:function(){return this.$store.state.user},emailVerification:function(){return this.$store.state.emailVerification},selectedColumn:{get:function(){return this.$store.state.emailVerification.column},set:function(t){this.$store.dispatch("emailVerification/setEmailVerificationForm",{column:t})}},options:{get:function(){return this.$store.state.emailVerification.options},set:function(t){this.$store.dispatch("emailVerification/setEmailVerificationForm",{options:t})}},columns:function(){var t=this.$store.state.emailVerification.columns;return t?t.map((function(t){return{label:"Column ".concat(t),value:t}})):[]}},methods:(0,h.Cl)((0,h.Cl)({},(0,x.i0)({setEmailVerificationForm:"emailVerification/setEmailVerificationForm",fetchActiveSheetColumns:"emailVerification/fetchActiveSheetColumns",fetchEmailsFromEmailColumn:"emailVerification/fetchEmailsFromEmailColumn",createEmailVerificationList:"emailVerification/createEmailVerificationList"})),{startVerification:function(){return(0,h.sH)(this,void 0,void 0,(function(){return(0,h.YH)(this,(function(t){switch(t.label){case 0:if(this.isLoading)return[2];if(!this.selectedColumn)return this.$bvToast.toast("Please select a column with email addresses.",{title:"Missing column",variant:"warning",solid:!0}),[2];this.isLoading=!0,t.label=1;case 1:return t.trys.push([1,4,5,6]),[4,this.fetchEmailsFromEmailColumn()];case 2:return t.sent(),0===this.emailVerification.emails.length?(this.$bvToast.toast("No email addresses found in the selected column.",{title:"No emails",variant:"warning",solid:!0}),[2]):[4,this.createEmailVerificationList()];case 3:return t.sent(),[3,6];case 4:return t.sent(),this.$bvToast.toast("Failed to create email verification list.",{title:"Error",variant:"danger",solid:!0}),[2];case 5:return this.isLoading=!1,[7];case 6:return this.$router.push({path:"/checkout"}),[2]}}))}))},close:function(){window.google.script.host.close()}})}),P=H;var L=(0,c.A)(P,d,f,!1,null,"7783e2b2",null);const A=L.exports;var O=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("b-container",{staticClass:"checkout"},[e("h1",{staticClass:"bec-title"},[t._v("Confirm order")]),e("CheckoutDetails",{attrs:{"free-credits":t.freeCredits},on:{confirm:t.processPayment}})],1)},F=[],$=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"checkout-details-component"},[e("b-row",{staticClass:"bec-description mb-1"},[e("b-col",[t._v("Emails in your list")]),e("b-col",[t._v(t._s(t.emails.length))])],1),e("hr"),e("b-row",{staticClass:"bec-description mb-1"},[e("b-col",[t._v("Total emails")]),e("b-col",[t._v(t._s(t.numberOfEmailsRemaining)+" emails")])],1),e("b-row",{staticClass:"bec-description mb-1"},[e("b-col",[t._v("Price per email")]),e("b-col",[t._v(t._s(t._f("formatPrice")(.01))+" per email")])],1),e("hr"),t.freeCheckout?t._e():[e("b-row",{staticClass:"bec-description mb-1"},[e("b-col",[t._v("Subtotal")]),e("b-col",[t._v(t._s(t._f("formatPrice")(t.subtotal)))])],1),e("b-row",{staticClass:"bec-description mb-1"},[e("b-col",[t._v("Minimum charge")]),e("b-col",[t._v(t._s(t._f("formatPrice")(.5)))])],1),e("hr")],e("b-row",{staticClass:"bec-description"},[e("b-col",[t._v("Total (excl. taxes)")]),e("b-col",{staticClass:"checkout-details__total"},[t._v(t._s(t._f("formatPrice")(t.total)))])],1),e("div",{staticClass:"terms-of-uses bec-description mt-3 mb-4"},[t._v(" By clicking "),e("strong",[t._v(t._s(t.confirmLabel))]),t._v(" you agree to the "),e("a",{attrs:{href:"https://mailmeteor.com/legal/terms"}},[t._v("Mailmeteor Agreement")]),t._v(", and the "),e("a",{attrs:{href:"https://mailmeteor.com/legal/bounceshield"}},[t._v("Supplemental Term for Mailmeteor BounceShield Agreement")]),t._v(". ")]),e("b-row",{staticClass:"justify-content-end mt-5 mr-0"},[e("b-button",{staticClass:"mr-2",attrs:{variant:"outline-secondary"},on:{click:function(e){return t.$router.back()}}},[t._v("Cancel")]),e("b-button",{attrs:{variant:"primary"},on:{click:function(e){return t.$emit("confirm")}}},[t._v(t._s(t.confirmLabel))])],1)],2)},I=[];const D=n["default"].extend({name:"checkout-details",components:{},props:{},computed:{confirmLabel:function(){return this.freeCheckout?"Start":"Proceed to payment"},emailVerification:function(){return this.$store.state.emailVerification},emails:function(){return this.emailVerification.emails},numberOfEmailsRemaining:function(){return this.emails.length},freeCheckout:function(){return!1},subtotal:function(){return.01*this.emails.length},total:function(){return this.freeCheckout?0:Math.max(this.subtotal,.5)}}}),U=D;var Y=(0,c.A)(U,$,I,!1,null,null,null);const j=Y.exports,T=n["default"].extend({name:"Checkout",components:{CheckoutDetails:j},data:function(){return{freeCredits:Math.floor(50*Math.random())}},computed:{paymentLink:function(){return this.$store.state.emailVerification.paymentLink}},methods:{processPayment:function(){window.open(this.paymentLink,"_blank"),this.$router.push("/processing-payment")}}}),M=T;var R=(0,c.A)(M,O,F,!1,null,null,null);const B=R.exports;var q=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("b-container",{staticClass:"processing-payment-page"},[e("ProcessState",{attrs:{title:"Payment in progress...",message:"Waiting for your payment to complete",actions:t.actions},on:{cancel:t.cancelPayment}})],1)},z=[],G=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"process-state-component"},[e("b-row",{staticClass:"text-center mb-3 mt-3"},[e("b-col",["loading"===t.type?e("b-spinner",{staticClass:"spinner",attrs:{variant:"primary"}}):e("img",{staticClass:"success-img",attrs:{src:"https://cdn.jsdelivr.net/gh/mailmeteor/cdn@7.9.3/dist/img/icons/done.svg"}})],1)],1),e("b-row",{staticClass:"mb-1"},[e("b-col",[e("h1",{staticClass:"bec-title text-center"},[t._v(t._s(t.title))])])],1),e("b-row",{staticClass:"mb-2"},[e("b-col",[e("p",{staticClass:"bec-description text-center"},[t._v(t._s(t.message))])])],1),e("b-row",{staticClass:"justify-content-center align-items-center action-buttons"},t._l(t.actions,(function(i){return e("b-col",{key:i.event,staticClass:"p-0 action-button"},[e("b-button",{key:i.event,attrs:{variant:i.type},on:{click:function(e){return t.$emit(i.event)}}},[t._v(" "+t._s(i.label)+" ")])],1)})),1)],1)},N=[];const W=n["default"].extend({name:"LoadingState",props:{type:{type:String,default:"loading"},title:{type:String,default:"Loading..."},message:{type:String,default:"Please wait while we load the data."},actions:{type:Array,default:function(){return[]}}}}),J=W;var Z=(0,c.A)(J,G,N,!1,null,null,null);const K=Z.exports,Q=n["default"].extend({name:"ProcessingPaymentPage",components:{ProcessState:K},data:function(){return{actions:[{label:"Cancel",event:"cancel",type:"outline-secondary"}]}},computed:{emailVerificationList:function(){return this.$store.state.emailVerification.emailVerificationList}},methods:{cancelPayment:function(){this.$store.dispatch("emailVerification/cancelPayment"),this.$router.replace({path:"/"})}},watch:{"emailVerificationList.status":{immediate:!0,handler:function(t){"active"===t?this.$router.push({path:"/processing-verification"}):"ended"===t&&this.$router.push({path:"/verification-complete"})}}}}),X=Q;var tt=(0,c.A)(X,q,z,!1,null,null,null);const et=tt.exports;var it=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"processing-verification-page"},[e("ProcessState",{attrs:{title:"Verification in progress...",message:"Your spreadsheet will be automatically updated in the background with the verification results."}})],1)},nt=[];const st=n["default"].extend({name:"ProcessingPaymentPage",components:{ProcessState:K},computed:{emailVerificationList:function(){return this.$store.state.emailVerification.emailVerificationList}},watch:{"emailVerificationList.status":{immediate:!0,handler:function(t){"ended"===t&&this.$router.push({path:"/verification-complete"})}}}}),at=st;var rt=(0,c.A)(at,it,nt,!1,null,null,null);const ot=rt.exports;var ct=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("b-container",{staticClass:"processing-payment-page"},[e("ProcessState",{attrs:{type:"success",title:"Verification completed",message:`Your list of ${t.emailVerification.emails.length} emails has been successfully verified.`,actions:t.actions},on:{cancel:t.cancel,"new-verification":t.newVerification}})],1)},lt=[];const ut=n["default"].extend({name:"ProcessingPaymentPage",components:{ProcessState:K},data:function(){return{actions:[{label:"Cancel",event:"cancel",type:"outline-secondary"},{label:"New verification",event:"new-verification",type:"primary"}]}},computed:{emailVerification:function(){return this.$store.state.emailVerification}},methods:(0,h.Cl)((0,h.Cl)({},(0,x.i0)({resetEmailVerificationForm:"emailVerification/resetEmailVerificationForm"})),{newVerification:function(){this.resetEmailVerificationForm(),this.$router.replace({path:"/"})},cancel:function(){this.resetEmailVerificationForm(),this.$router.replace({path:"/"}),window.google.script.host.close()}})}),mt=ut;var dt=(0,c.A)(mt,ct,lt,!1,null,null,null);const ft=dt.exports;n["default"].use(m.Ay);var ht=[{path:"/",component:A},{path:"/checkout",component:B},{path:"/processing-payment",component:et},{path:"/processing-verification",component:ot},{path:"/verification-complete",component:ft}];const pt=new m.Ay({mode:"history",routes:ht});i(1148),i(4979);var vt=i(9988);i(4364),i(8889);function bt(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return new Promise((function(i,n){var s;(s=window.google.script.run.withSuccessHandler(i).withFailureHandler(n||window.errorBackendHandler))[t].apply(s,e)}))}i(1690),i(5611);var gt=i(7091);function wt(t,e){return void 0===e&&(e=!1),(0,h.sH)(this,void 0,Promise,(function(){var i,n,s;return(0,h.YH)(this,(function(a){switch(a.label){case 0:return i=vt.A.database().ref(t),e?[4,i.get()]:[3,2];case 1:return s=a.sent(),[3,4];case 2:return[4,i.once("value")];case 3:s=a.sent(),a.label=4;case 4:return n=s,[2,n.val()||{}]}}))}))}function yt(t){return(0,h.sH)(this,void 0,Promise,(function(){var e;return(0,h.YH)(this,(function(i){switch(i.label){case 0:return[4,t.get()];case 1:return e=i.sent(),[2,e.docs.map((function(t){return(0,h.Cl)({id:t.id},t.data())}))]}}))}))}function _t(t){return new gt.c((function(e){var i=t.onSnapshot((function(t){var i=t.docs.map((function(t){return(0,h.Cl)({id:t.id},t.data())}));e.next(i)}),(function(t){e.error(t)}));return function(){return i()}}))}var Ct={uid:"",email:"",quota:{limit:50,available:50,usage:0,refreshDate:""},blocked:!1,isLogged:!1,isProfileFetched:!1},Vt={initialize:function(t){return(0,h.sH)(this,void 0,void 0,(function(){var e,i;return(0,h.YH)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,t.dispatch("signin")];case 1:return e=n.sent(),[4,t.dispatch("fetchProfile",e)];case 2:return n.sent(),t.dispatch("onDataFetched"),[3,4];case 3:return i=n.sent(),i instanceof Error&&"Multiple accounts detected!"===i.message?[2]:(t.dispatch("signInFailed",i),[3,4]);case 4:return[2]}}))}))},onDataFetched:function(t){t.dispatch("ready","user",{root:!0})},fetchProfile:function(t){return(0,h.sH)(this,void 0,Promise,(function(){var e,i,n,s,a;return(0,h.YH)(this,(function(r){switch(r.label){case 0:if(e=vt.A.auth().currentUser,!e)throw new Error("User is not signed in.");return[4,wt("users/".concat(e.uid,"/profile"))];case 1:return i=r.sent(),n=e.email||"",s={available:50,limit:50,usage:0,refreshDate:""},a={uid:e.uid,quota:s,blocked:(null===i||void 0===i?void 0:i.blocked)||!1,email:n},t.commit("set",a),t.dispatch("onDataFetched"),[2,a]}}))}))},signin:function(t){return(0,h.sH)(this,void 0,Promise,(function(){var e,i;return(0,h.YH)(this,(function(n){switch(n.label){case 0:return[4,Et()];case 1:return e=n.sent(),e?[3,3]:[4,xt()];case 2:e=n.sent(),n.label=3;case 3:if(!(null===e||void 0===e?void 0:e.user))throw new Error("Unable to sign in");return i=e.user,t.state.uid=i.uid,t.state.email=i.email||"",t.dispatch("onAuthChange"),t.dispatch("logged",!0),[2,e]}}))}))},onAuthChange:function(t){var e=this;vt.A.auth().onAuthStateChanged((function(i){return(0,h.sH)(e,void 0,void 0,(function(){var e;return(0,h.YH)(this,(function(n){switch(n.label){case 0:if(i)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,t.dispatch("signin")];case 2:return n.sent(),[3,4];case 3:return e=n.sent(),t.dispatch("loggedOut",e),[3,4];case 4:return[2]}}))}))}))},logged:function(t,e){t.commit("logged",e)},loggedOut:function(t,e){t.dispatch("logged",!1),window._logger(e)},signInFailed:function(t,e){t.dispatch("logged",!1),window._logger(e)},signout:function(){vt.A.auth().signOut()}},St={set:function(t,e){t.uid=e.uid,t.email=e.email,t.blocked=e.blocked,t.isProfileFetched=!0,e.quota&&e.quota.available<0&&(e.quota.available=0),n["default"].set(t,"quota",e.quota)},logged:function(t,e){t.isLogged=e}};const kt={namespaced:!0,state:Ct,actions:Vt,mutations:St};function Et(){return(0,h.sH)(this,void 0,void 0,(function(){var t,e,i,n;return(0,h.YH)(this,(function(s){switch(s.label){case 0:if(t=JSON.parse(Lt("credential")||"{}"),e=null===t||void 0===t?void 0:t.token,i=(null===t||void 0===t?void 0:t.token_expires_at)||0,n=e&&i>Date.now()+6e5,!n)return[2,null];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,vt.A.auth().signInWithCustomToken(e)];case 2:return[2,s.sent()];case 3:return s.sent(),[2,null];case 4:return[2]}}))}))}function xt(){return(0,h.sH)(this,void 0,void 0,(function(){var t,e,i,n,s;return(0,h.YH)(this,(function(a){switch(a.label){case 0:return[4,bt("UIDataCurrentUserSession")];case 1:if(t=a.sent(),e=t.oauth_token,i=t.email,!e)throw new Error("Missing user session token");if(!i)throw new Error("Missing user email");if(i!==window._app.data.activeUserEmail)throw new Error("Multiple accounts detected!");return[4,vt.A.functions().httpsCallable("addon_gworkspace-login")({email:i,oauth_token:e})];case 2:if(n=a.sent(),s=n.data.token,!s)throw new Error("Unable to retrieve user token from Firebase");return Pt("credential",JSON.stringify({token:s,token_expires_at:Date.now()+33e5})),[2,vt.A.auth().signInWithCustomToken(s)]}}))}))}function Ht(t){var e=btoa(window._app.data.activeUserEmail||Date.now().toString()),i="MM_USER_".concat(e,"_").concat(t.toUpperCase());return i}function Pt(t,e){try{window.localStorage.setItem(Ht(t),e)}catch(i){}}function Lt(t){try{return window.localStorage.getItem(Ht(t))}catch(e){return null}}var At=i(6126),Ot=i(3720);function Ft(t){return"emvl_".concat(t)}function $t(t,e){var i=vt.A.firestore().collection("email_verification_lists").where("owner","==",t).where("googlesheets.sheet","==",e).where("status","!=","payment_required").orderBy("status").orderBy("updated_at","desc").limit(1);return _t(i)}function It(t,e){return(0,h.sH)(this,void 0,void 0,(function(){var i,n;return(0,h.YH)(this,(function(s){return i=e.id,n=vt.A.firestore().collection("email_verifications").where("owner","==",t).where("verification_list","==","emvl_".concat(i)).orderBy("created_at","desc"),[2,yt(n)]}))}))}function Dt(t,e){var i=e.id,n=vt.A.firestore().collection("email_verifications").where("owner","==",t).where("verification_list","==","emvl_".concat(i)).orderBy("created_at","desc");return _t(n)}i(7588);var Ut=function(){function t(){this.subscriptions=new Map}return t.prototype.set=function(t,e){this.unsubscribe(t),this.subscriptions.set(t,e)},t.prototype.unsubscribe=function(t){var e;this.subscriptions.has(t)&&(null===(e=this.subscriptions.get(t))||void 0===e||e.unsubscribe(),this.subscriptions.delete(t))},t.prototype.unsubscribeAll=function(){this.subscriptions.forEach((function(t){return t.unsubscribe()})),this.subscriptions.clear()},t}(),Yt=new Ut,jt=i(9449),Tt=function(){function t(t,e){this.uid=t,this.emailVerificationList=e,this.subscription=null,this.flushInterval=2e3}return t.prototype.updateEmailVerificationList=function(){var t=this;this.subscription&&this.stop();var e=Dt(this.uid,this.emailVerificationList);this.subscription=e.pipe((0,jt.Z)(this.flushInterval)).subscribe((function(e){return t.updateSheet(e)})),Yt.set("emailVerificationSheetHandler",this.subscription)},t.prototype.stop=function(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null,Yt.unsubscribe("emailVerificationSheetHandler"))},t.prototype.updateSheet=function(t){return(0,h.sH)(this,void 0,Promise,(function(){var e;return(0,h.YH)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t.length>0?[4,bt("UIUpdateSheetStatuses",this.emailVerificationList,t)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[3,4];case 3:return e=i.sent(),console.error("Failed to update Google Sheet:",e),[3,4];case 4:return[2]}}))}))},t}(),Mt={sheet:"",emails:[],options:{hasHeaderRows:!1,includeVerificationDetails:!1},column:"",emailVerificationListId:"",emailVerificationList:null,paymentLink:"",columns:[],sheetHandler:null},Rt={initialize:function(t){return(0,h.sH)(this,void 0,void 0,(function(){var e;return(0,h.YH)(this,(function(i){switch(i.label){case 0:return e=[t.dispatch("fetchActiveSheetColumns"),t.dispatch("fetchDefaultEmailColumn")],[4,Promise.all(e)];case 1:return i.sent(),t.dispatch("ready","emailVerification",{root:!0}),[2]}}))}))},setSheet:function(t,e){t.commit("setSheet",e),t.dispatch("sheetChanged",e,{root:!0})},setEmailVerificationForm:function(t,e){t.commit("setEmailVerificationForm",e)},resetEmailVerificationForm:function(t){t.commit("resetEmailVerificationForm")},fetchActiveSheetColumns:function(t){return(0,h.sH)(this,void 0,void 0,(function(){var e;return(0,h.YH)(this,(function(i){switch(i.label){case 0:return[4,bt("UIGetAllColumnsFromCurrentSheet")];case 1:return e=i.sent(),t.commit("setColumns",e),[2]}}))}))},fetchDefaultEmailColumn:function(t){return(0,h.sH)(this,void 0,void 0,(function(){var e;return(0,h.YH)(this,(function(i){switch(i.label){case 0:return[4,bt("UIGetEmailColumnFromCurrentSheet")];case 1:return e=i.sent(),t.dispatch("setSheet",e.sheet),t.commit("setEmailVerificationForm",{column:e.columnHeading,options:(0,h.Cl)((0,h.Cl)({},t.state.options),{hasHeaderRows:e.hasHeader})}),[2]}}))}))},fetchEmailsFromEmailColumn:function(t){return(0,h.sH)(this,void 0,void 0,(function(){var e,i,n,s;return(0,h.YH)(this,(function(a){switch(a.label){case 0:return e=t.state,i=e.column,n=e.options,i?[4,bt("UIGetEmailsFromCurrentSheet",i,n.hasHeaderRows)]:[2];case 1:return s=a.sent(),t.commit("setEmailVerificationForm",{emails:s}),[2]}}))}))},fetchEmailVerificationLists:function(t,e){var i=this,n=$t(e,t.state.sheet),s=n.pipe((0,At.p)((function(t){return t.length>0})),(0,Ot.n)((function(t){return(0,h.sH)(i,void 0,void 0,(function(){return(0,h.YH)(this,(function(e){return[2,t[0]]}))}))}))).subscribe((function(n){return(0,h.sH)(i,void 0,void 0,(function(){var i,s;return(0,h.YH)(this,(function(a){switch(a.label){case 0:return t.state.emailVerificationListId&&t.state.emailVerificationListId!==Ft(n.id)?[2]:(t.commit("setEmailVerificationList",n),"active"!==n.status?[3,2]:(i=new Tt(e,n),t.commit("setSheetHandler",i),[4,bt("UISetSheetVerifyingStatusColumn",n.googlesheets.add_details,n)]));case 1:return a.sent(),i.updateEmailVerificationList(),[3,4];case 2:return"ended"!==n.status?[3,4]:(t.commit("setSheetHandler",null),[4,It(e,n)]);case 3:return s=a.sent(),[2,bt("UIUpdateSheetStatuses",n,s)];case 4:return[2]}}))}))}));Yt.set("emailVerificationLists",s)},createEmailVerificationList:function(t){return(0,h.sH)(this,void 0,void 0,(function(){var e,i,n,s,a,r,o,c,l;return(0,h.YH)(this,(function(u){switch(u.label){case 0:return e=t.state,i=e.emails,n=e.column,s=e.options,a={emailingColumn:n,options:{hasHeader:s.hasHeaderRows,addDetails:s.includeVerificationDetails},emails:i},[4,bt("UICreateVerificationList",a)];case 1:return r=u.sent(),o=r.id,c=r.payment_link,l=r.sheet,t.commit("initializeEmailVerificationList",{id:o,payment_link:c}),t.dispatch("setSheet",l),[2]}}))}))},cancelPayment:function(t){t.commit("setEmailVerificationList",null),t.commit("initializeEmailVerificationList",{id:"",payment_link:""})}},Bt={setEmailVerificationForm:function(t,e){e.options&&(t.options=e.options),e.column&&(t.column=e.column),e.emails&&(t.emails=e.emails)},initializeEmailVerificationList:function(t,e){t.emailVerificationList=null,t.emailVerificationListId=e.id,t.paymentLink=e.payment_link},setEmailVerificationList:function(t,e){t.emailVerificationList=e},resetEmailVerificationForm:function(t){t.emails=[],t.options={hasHeaderRows:!1,includeVerificationDetails:!1},t.column=""},setColumns:function(t,e){t.columns=e},setSheet:function(t,e){t.sheet=e},setSheetHandler:function(t,e){t.sheetHandler&&t.sheetHandler.stop(),t.sheetHandler=e}};const qt={namespaced:!0,state:Mt,actions:Rt,mutations:Bt};n["default"].use(x.Ay);const zt=new x.Ay.Store({modules:{user:kt,emailVerification:qt},state:{ready:!1,loaded:{user:!1,emailVerification:!1}},actions:{ready:function(t,e){t.commit("loaded",e);var i=Object.values(t.state.loaded).every((function(t){return t}));if(i)return t.commit("ready")},sheetChanged:function(t){t.dispatch("emailVerification/fetchEmailVerificationLists",kt.state.uid,{root:!0})}},mutations:{ready:function(t){t.ready=!0},loaded:function(t,e){t.loaded[e]=!0}}});n["default"].filter("formatPrice",(function(t){return"number"!==typeof t?"Invalid value":t.toLocaleString("en-US",{style:"currency",currency:"USD"})}));var Gt=i(8292);i(9313);n["default"].use(Gt.vGs),new n["default"]({store:zt,router:pt,render:function(t){return t(u)},created:function(){vt.A.initializeApp(window._app&&window._app.firebase),this.$store.dispatch("user/initialize"),this.$store.dispatch("emailVerification/initialize")}}).$mount("#app")}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var a=e[n]={exports:{}};return t[n].call(a.exports,a,a.exports,i),a.exports}i.m=t,(()=>{var t=[];i.O=(e,n,s,a)=>{if(!n){var r=1/0;for(u=0;u<t.length;u++){for(var[n,s,a]=t[u],o=!0,c=0;c<n.length;c++)(!1&a||r>=a)&&Object.keys(i.O).every((t=>i.O[t](n[c])))?n.splice(c--,1):(o=!1,a<r&&(r=a));if(o){t.splice(u--,1);var l=s();void 0!==l&&(e=l)}}return e}a=a||0;for(var u=t.length;u>0&&t[u-1][2]>a;u--)t[u]=t[u-1];t[u]=[n,s,a]}})(),(()=>{i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}})(),(()=>{i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()})(),(()=>{i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e)})(),(()=>{i.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}})(),(()=>{var t={524:0};i.O.j=e=>0===t[e];var e=(e,n)=>{var s,a,[r,o,c]=n,l=0;if(r.some((e=>0!==t[e]))){for(s in o)i.o(o,s)&&(i.m[s]=o[s]);if(c)var u=c(i)}for(e&&e(n);l<r.length;l++)a=r[l],i.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return i.O(u)},n=globalThis["webpackChunknewapp"]=globalThis["webpackChunknewapp"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var n=i.O(void 0,[504],(()=>i(3368)));n=i.O(n)})();